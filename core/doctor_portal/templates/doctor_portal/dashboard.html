{% extends 'hospital/base.html' %}

{% block title %}Doctor Dashboard{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Doctor Portal</h2>
    <div>
      <a class="btn btn-sm btn-outline-secondary" href="{% url 'doctor_portal:logout' %}">Logout</a>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-md-12">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="card-title">Assigned Patients</h5>
          <ul class="list-group list-group-flush">
            {% for p in patients %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>{{ p.name }}</span>
                <a class="btn btn-sm btn-primary" href="{% url 'doctor_portal:patient_detail' p.id %}">Open</a>
              </li>
            {% empty %}
              <li class="list-group-item">No patients assigned.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-3 mt-1">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Recent Reports</h5>
          <div class="table-responsive">
            <table class="table table-striped table-sm">
              <thead><tr><th>Date</th><th>Patient</th><th>Type</th></tr></thead>
              <tbody>
                {% for r in recent_reports %}
                  <tr><td>{{ r.created_at }}</td><td>{{ r.patient.name }}</td><td>{{ r.report_type }}</td></tr>
                {% empty %}
                  <tr><td colspan="3">No reports yet.</td></tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-3 mt-1">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">All Appointments</h5>
          <div class="table-responsive">
            <table class="table table-striped table-sm">
              <thead><tr><th>Date</th><th>Patient</th><th>Status</th></tr></thead>
              <tbody>
                {% for a in appointments %}
                  <tr><td>{{ a.date }}</td><td>{{ a.patient.name }}</td><td>{{ a.status }}</td></tr>
                {% empty %}
                  <tr><td colspan="3">No appointments found.</td></tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

